---
title: "CanidSelection"
author: "Anonymous"
date: "2024-02-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Loading packages and organising data

Setting the working directory as "Analysis" folder (**please adjust to suit your working directory**):

```{r}
setwd("~/1) MBiol Project/Green_Status_Analysis/Analysis")
```


Loading in libraries, data, and functions:

```{r, warning = FALSE, message = FALSE}
source("Functions/Libraries.r")
SpeciesData <- read.csv("Data/CF_Data.csv")
```


Making a dataset including my 20 felid species, and 20 potential canid species

Canid species: Canis (6), Chrysocyon (1), Cuon (1), Lupulella (2), Lycaon (1), Nyctereutes (1), Otocyon (1), Speothos (1), Urocyon littoralis, Vulpes cana, Vulpes zerda, Vulpes pallida, Vulpes vulpes, Vulpes ferrilata.

```{r}
RNS <- c(1:11,20:28,41,43,46,48,51,53:60,70:73,76:78)
SubData <- SpeciesData[RNS,]
nrow(SubData)
```

# Testing for normality:


Shapiro-Wilk test of normality

```{r}
#Testing the normality of the variables
shapiro.test(SubData$Avg_ABM)
shapiro.test(SubData$HR)
shapiro.test(SubData$GL)
```

Shapiro-Wilk test of normality (with Avg Adult Body Mass and Home Range Size logged)

```{r}
#Adding columns for the log of Average Adult Body Mass and Home Range Size.
SubData <- mutate(SubData, logBM = log(Avg_ABM))
SubData <- mutate(SubData, logHR = log(HR))

#Testing the normality of the variables
shapiro.test(SubData$logBM)
shapiro.test(SubData$logHR)
shapiro.test(SubData$GL)
```

Plotting qqplots to visually assess normality

```{r}
#QQplots
par(mfrow = c(1,3))
qqnorm(SubData$logBM, pch = 1, frame = FALSE)
qqline(SubData$logBM, col = "steelblue", lwd = 2)
qqnorm(SubData$logHR, pch = 1, frame = FALSE)
qqline(SubData$logHR, col = "steelblue", lwd = 2)
qqnorm(SubData$GL, pch = 1, frame = FALSE)
qqline(SubData$GL, col = "steelblue", lwd = 2)
```


# Contrasting predictor variables between Canidae and Felidae

Boxplots:

Average Adult Body Mass (logged)

```{r}
ggplot(SubData, aes(Family, logBM, colour = Family)) + geom_boxplot() + geom_point()
```

Average Adult Body Mass

```{r}
ggplot(SubData, aes(Family, Avg_ABM, colour = Family)) + geom_boxplot() + geom_point()
```

Home Range Size (logged)

```{r}
ggplot(SubData, aes(Family, logHR, colour = Family)) + geom_boxplot() + geom_point()
```

Home Range Size

```{r}
ggplot(SubData, aes(Family, HR, colour = Family)) + geom_boxplot() + geom_point()
```

Generation Length

```{r}
ggplot(SubData, aes(Family, GL, colour = Family)) + geom_boxplot() + geom_point()
```

Bar Charts for categorical variables:

Red List Category

```{r}
ggplot(SubData, aes(Family, colour = Red.List.Status, fill = Red.List.Status)) + geom_bar()
```

Georgaphic Range Size

```{r}
ggplot(SubData, aes(Family, colour = Geog_Range, fill = Geog_Range)) + geom_bar()
```

Body Mass Class

```{r}
ggplot(SubData, aes(Family, colour = BMC, fill = BMC)) + geom_bar()
```

Scatterplots between 2 continuous variables:

Avg. Adult Body Mass (logged) against Home Range Size (logged)

```{r}
ggplot(SubData, aes(logBM, logHR, colour = Family, fill = Family)) + geom_point()
```

Generation Length against Home Range Size (logged)

```{r}
ggplot(SubData, aes(logBM, GL, colour = Family, fill = Family)) + geom_point()
```

Generation Length against Home Range Size (logged)

```{r}
ggplot(SubData, aes(GL, logHR, colour = Family, fill = Family)) + geom_point()
```

Exploring the data by genus:

Average Adult Body Mass (logged)

```{r}
ggplot(SubData, aes(Genus, logBM, colour = Family)) + geom_boxplot() + geom_point() + theme(axis.text.x = element_text(angle = 90))
```

Home Range Size (logged)

```{r}
ggplot(SubData, aes(Genus, logHR, colour = Family)) + geom_boxplot() + geom_point() + theme(axis.text.x = element_text(angle = 90))
```

Generation Length

```{r}
ggplot(SubData, aes(Genus, GL, colour = Family)) + geom_boxplot() + geom_point() + theme(axis.text.x = element_text(angle = 90))
```
